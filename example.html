<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <script src="raphael.js" type="text/javascript"></script>
        <script src="underscore.js" type="text/javascript"></script>
        <script src="force.js" type="text/javascript"></script>
    </head>
    <body>
        <script type="text/javascript">
            var paper = Raphael(10, 10, 400, 400);
            objs = [];
            /*
            var ball = new Obj({ pos: new Vector(10, 10), vel: new Vector(20, 17), r: 10 });
            ball.set("mass", 10);
            ball.draw(paper, { fill: "blue" });
            var rock = new Obj({ pos: new Vector(100, 50), r: 20 });
            rock.set("mass", 40); 
            rock.draw(paper, { fill: "grey"});
            objs = objs.concat([ball, rock]);
            */
            var chain = [];
            for(var i = 0; i < 20; i++){
                chain[i] = new Obj({ pos : new Vector(30 + i * 11, 70+ish ), r : 5});
                chain[i].set("spring", 10 + i);
                chain[i].set("mass", 3);
                chain[i].draw(paper, {fill: Raphael.getColor() });
            }
            objs = objs.concat(chain);
            
            var gravity = new Force({ prop: "mass", coeff: 1000 });
            //gravity.draw(paper, ball, rock, {"scale": 1, stroke: "green"});
            
            var spring = new Force({ prop: "spring", coeff: 0.1, fn: "linDist"})
            //spring.draw(paper, chain[0], chain[1], paper, {stroke: "orange"}); 
            
            
            setInterval(function(){
               
                for(var i = 0; i < 19; i++){
                    spring.act(chain[i], chain[i+1], 0.1);
                }
                
                for(var i = 0; i < objs.length; i++){
                    for(var j = 0; j < i; j++){
                        collision(objs[i], objs[j]);
                        gravity.act(objs[i], objs[j], 0.1);
                        
                    }
                    
                    
                }
                for(var i = 0; i < objs.length; i++){
                    objs[i].move(0.1);
                    objs[i].draw(paper);
                }
                
                /*
                
                
                ball.draw(paper, {fill : Raphael.getColor() }, {stroke : "blue"});
                rock.draw(paper, {}, {stroke : "blue"});
                gravity.draw(paper, ball, rock);
                */
            }, 100);
        </script>
    </body> 
</html>
